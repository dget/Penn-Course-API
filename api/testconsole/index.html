<html>
<head><title>Test Console</title>
<style type="text/css">
.success_box {
   background-color: #ddf5eb;
   border-color: #333399;
}
.error_box {
   background-color: #ffcccc;
   border-color: #cc0000;
}
.padded {
   padding-left: 10px;
   padding-top: 10px;
   padding-right: 10px;
   padding-bottom: 10px;
}
div#output {
   border-style: solid;
   font-family: monospace;
}
div#addressDisplay {
   padding-bottom: 10px;
}
</style>
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.4.0/jquery.min.js"></script> 
<script type="text/javascript">
function loadInputJSON() {
   baseurl = 'http://www.pennapps.com/' + $('#base').val();
   var page = $('#address').val();
   return loadJSON(baseurl, page);
}

function loadJSON(baseurl, page) {
   baseurl = baseurl.replace(/\/$/,"");
   page = page.replace(/^\//,"");
   var addr = baseurl + "/" + page;
   linkobj = $("<div>Source: <a href = '"+addr+"'>"+addr+"</a></div>");
   $('#addressDisplay').html(linkobj);

   $('#output').unbind('ajaxError');
   $('#output').ajaxError(function(e, xhr, set, exc) {
      $('#output').removeClass('error_box success_box').addClass('error_box');
      addr = set.url;
      frame = $("<div class='padded'><iframe src = '"+addr+"' width='100%' height='100%'/></div>");
      $('#output').html(frame);
   });

   $.get(addr, function(data) {
      $('#output').removeClass('error_box success_box').addClass('success_box');
      data = data.replace(/"url": "(.*?)"/g, function(all, url) {
         return '"url": "<a href="#" onClick="loadJSON(\''+baseurl+'\',\''+url+'\');">'+url+'</a>"';
      });
      data = "<pre>" + data + "</pre>"
      $('#output').html(data);
   });

  return false;
}
</script>
</head>
<body>
<form onSubmit = "return loadInputJSON();">
http://www.pennapps.com/
<select id="base">
   <option>api/</option>
   <option selected="true">apiv2/</option>
</select>
<input id = "address" size="50" value = "/courses/course/">
<input type = "submit" value = "Load">
</form>
<div id = "display" class = "padded">
<div id = "addressDisplay">No data loaded.</div>
<div id = "output" class = "padded"></div>
</div>
</body>
</html>